---
ms.openlocfilehash: ca2cf748b426d17058b55202a60ece01d9e05592
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052412"
---
# <a name="node-abort-controller"></a>node-abort-controller

Полизаполнение AbortController для Node.JS на основе EventEmitter

[![Статус сборки](https://dev.azure.com/stfaul/node-abort-controller/_apis/build/status/southpolesteve.node-abort-controller?branchName=master)](https://dev.azure.com/stfaul/node-abort-controller/_build/latest?definitionId=3&branchName=master)

## <a name="usage"></a>Использование

```js
import fetch from 'node-fetch'
import AbortController from 'node-abort-controller'

const controller = new AbortController()
const signal = controller.signal

await fetch('https:/www.google.com', { signal })

// Abort after 500ms. Effectively a timeout
setTimeout(() => controller.abort(), 500)
```

## <a name="why-would-i-use-this"></a>Зачем это использовать

Возможно, вам это не нужно. В целом, код JavaScript может выполняться в трех средах:

- Узел
- Современные браузеры (не Internet Explorer)
- Устаревшие браузеры (в основном Internet Explorer)

Для современных API JS каждая среда в идеале получает полизаполнение:

- только если оно требуется;
- для конкретной платформы.

Реализовать это на практике трудно. Такие инструменты, как webpack и browserify, отлично подходят для того, чтобы заставить решения работать по умолчанию во всех средах. Однако, используя их, довольно легко не соблюсти оба условия выше. Вполне вероятно, что вы предоставите не самые удачные полизаполнения на платформах, на которых они не требуются. Итак, что нужно сделать разработчику? В случае с `fetch` и `AbortController` я все сделал за вас. Здесь приводится инструкция по работе.

Если вы разрабатываете...

#### <a name="application-running-in-modern-browsers"></a>Приложение, работающее в современных браузерах:

Поздравляем! Вам вообще не нужна эта библиотека или полизаполнение! Можете не читать дальше. Удалите этот пакет.

#### <a name="application-running-in-modern-browsers-and-node-such-as-a-server-side-rendered-js-app"></a>Приложение, работающее в современных браузерах И в node.js (например, серверное приложение JS):

Используйте _этот пакет_ и [node-fetch](https://www.npmjs.com/package/node-fetch). Это минимально необходимый набор.

#### <a name="application-supporting-legacy-browsers-and-not-node"></a>Приложение, поддерживающее устаревшие браузеры НО НЕ node.js:

Используйте [abort-controller](https://www.npmjs.com/package/abort-controller) и [whatwg-fetch](https://www.npmjs.com/package/whatwg-fetch). Это более полные полизаполнения, которые работают во всех браузерных средах.

#### <a name="application-supporting-legacy-browsers-and-node"></a>Приложение, поддерживающее устаревшие браузеры И node.js:

Используйте [abort-controller](https://www.npmjs.com/package/abort-controller) и [cross-fetch](https://www.npmjs.com/package/cross-fetch). То же, что и выше, за исключением того, что cross-fetch правильно выполняет полизаполнение и в браузере, и в node.js

#### <a name="library-being-consumed-by-other-applications-and-using-fetch-internally"></a>Библиотеку, которая используется другими приложениями и внутри которой используется `fetch`:

Используйте _этот пакет_ и [node-fetch](https://www.npmjs.com/package/node-fetch). Это минимальное и наиболее компромиссное сочетание для конечных пользователей. Разработчикам приложений для Internet Exploer потребуется создавать полизаполнения `AbortController` и `fetch` самостоятельно. Но библиотека не будет требовать полизаполнений от разработчиков, которые создают решения только для современных браузеров.

## <a name="goals"></a>Цели

Учитывая сказанное выше, эта библиотека имеет весьма конкретный набор целей:

1. Предоставить минимальное полизаполнение в node.js.
2. Не предоставлять полизаполнение для любой браузерной среды.

Она идеально подходит для _разработчиков библиотек_, которые используют `fetch` и `AbortController` для внутренних задач и создают свои решения _как для браузеров, так и для node.js_.

## <a name="prior-art"></a>Предыдущая работа

Спасибо @mysticatea за разработку https://github.com/mysticatea/abort-controller. Это замечательное полизаполнение `AbortController`, которое идеально подходит для многих вариантов использования.
