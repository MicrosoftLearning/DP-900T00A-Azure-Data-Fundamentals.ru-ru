---
ms.openlocfilehash: 5f4ff1937c647160a418ca9c807267dc22e5e09f
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052668"
---
ПРИМЕЧАНИЕ. Ветка по умолчанию была переименована!
имя master теперь называется main

Если у вас есть локальный клон, его можно обновить, выполнив следующие действия:

```shell
git branch -m master main
git fetch origin
git branch -u origin/main main
```

# <a name="node-addon-api-module"></a>**Модуль node-addon-api**
Этот модуль содержит **классы-оболочки C++ (только с заголовками),** которые упрощают использование [API узла](https://nodejs.org/dist/latest/docs/api/n-api.html) на основе кода C из Node.js при использовании C++. Модуль предоставляет объектную модель C++ и семантику обработки исключений с низкими затратами.

Используются три варианта реализации надстроек: Node-API, nan или прямое использование внутренних библиотек V8, libuv и Node.js. Если не требуется прямой доступ к функциям, которые не предоставляются Node-API, как описано в [надстройках C/C++](https://nodejs.org/dist/latest/docs/api/addons.html) в Node.js core, используйте Node-API. Дополнительные сведения о Node-API см. в [надстройках C/C++ с Node-API](https://nodejs.org/dist/latest/docs/api/n-api.html).

Node-API — это стабильный интерфейс C ABI, предоставляемый Node.js для создания собственных надстроек. Это не зависит от базовой среды выполнения JavaScript (например, V8 или ChakraCore) и поддерживается как часть самого Node.js. Он предназначен для изоляции собственных надстроек от изменений в базовой подсистеме JavaScript и позволяет модулям, скомпилированным для одной версии, работать в более поздних версиях Node.js без повторной компиляции.

Модуль `node-addon-api`, который не является частью Node.js, сохраняет преимущества Node-API, так как состоит только из встроенного кода, зависящего только от стабильного API от Node-API. Таким образом, модули, созданные на основе одной версии Node.js с помощью node-addon-api, должны выполняться без повторной сборки с помощью более новых версий Node.js.

Важно помнить, что *другие* интерфейсы Node.js, такие как `libuv` (включенные в проект через `#include <uv.h>`) не являются стабильными по ABI в основных версиях Node.js. Таким образом, надстройка должна использовать Node-API и/или исключительно `node-addon-api` и выполнять сборку для версии Node.js, которая включает реализацию Node-API (то есть активную версию Node.js LTS), чтобы воспользоваться стабильностью ABI в основных версиях Node.js. Node.js предоставляет [руководство по стабильности ABI][], содержащее подробное описание стабильности ABI в целом, а также гарантию стабильности Node-API ABI.

Так как новые API добавляются в Node-API, необходимо обновить node-addon-api, чтобы предоставить программы-оболочки для этих новых API. По этой причине node-addon-api предоставляет методы, позволяющие вызывающим объектам получать базовые дескрипторы Node-API, поэтому прямые вызовы к Node-API и использование объектов и методов, предоставляемых node-addon-api, можно использовать вместе. Например, чтобы использовать API, для которого node-addon-api еще не предоставляет программу-оболочку.

Интерфейсы API, предоставляемые node-addon-api, как правило, используются для создания значений JavaScript и управления ими. Основные понятия и операции, обычно, сопоставляют с идеями, указанными в **спецификации языка ECMA262**.

Ресурс [Node-API](https://nodejs.github.io/node-addon-examples/)  предоставляет отличную ориентацию и советы для разработчиков, которые только начинают работу с Node-API и node-addon-api.

- **[Настройка](#setup)**
- **[Документация по API](#api)**
- **[Примеры](#examples)**
- **[Тесты](#tests)**
- **[Дополнительные сведения о ресурсах и собственных надстройках](#resources)**
- **[Значки](#badges)**
- **[Правила поведения](CODE_OF_CONDUCT.md)**
- **[Соавторы](#contributors)**
- **[Лицензия](#license)**

## <a name="current-version-321"></a>**Текущая версия: 3.2.1**

(См. полный журнал изменений [CHANGELOG.md](CHANGELOG.md))

[![NPM](https://nodei.co/npm/node-addon-api.png?downloads=true&downloadRank=true)](https://nodei.co/npm/node-addon-api/) [![NPM](https://nodei.co/npm-dl/node-addon-api.png?months=6&height=1)](https://nodei.co/npm/node-addon-api/)

<a name="setup"></a>

node-addon-api основан на [Node-API](https://nodejs.org/api/n-api.html) и поддерживает использование различных версий Node-API.
Это позволяет надстройкам, построенным с его помощью, запускаться с Node.js версиями, которые поддерживают целевую версию Node-API.
**Однако** модель поддержки node-addon-api заключается в поддержке только активных версий Node.js LTS. Это означает, что каждый год будет новый основной номер версии, который снижает поддержку Node.js LTS версии, выводимой из эксплуатации.

Самая старая версия Node.js, поддерживаемая текущей версией node-addon-api, Node.js 10.x.

## <a name="setup"></a>Настройка
  - [Установка и использование](doc/setup.md)
  - [node-gyp](doc/node-gyp.md)
  - [cmake-js](doc/cmake-js.md)
  - [Конвертер](doc/conversion-tool.md)
  - [Средство проверки](doc/checker-tool.md)
  - [Generator](doc/generator.md)
  - [Средства предварительной сборки](doc/prebuild_tools.md)

<a name="api"></a>

### <a name="api-documentation"></a>**Документация по API**

Ниже приведена документация по node-addon-api.

 - [Полная иерархия классов](doc/hierarchy.md)
 - [Структура надстройки](doc/addon.md)
 - Типы данных:
    - [Env](doc/env.md)
    - [CallbackInfo](doc/callbackinfo.md)
    - [Ссылки](doc/reference.md)
    - [Значение](doc/value.md)
        - [Имя](doc/name.md)
            - [Символ](doc/symbol.md)
            - [String](doc/string.md)
        - [Число](doc/number.md)
        - [Date](doc/date.md)
        - [BigInt](doc/bigint.md)
        - [Boolean](doc/boolean.md)
        - [Внешний](doc/external.md)
        - [Объект](doc/object.md)
            - [массив](doc/array.md).
            - [ObjectReference](doc/object_reference.md)
    - [PropertyDescriptor](doc/property_descriptor.md)
    - [Компонент](doc/function.md)
        - [FunctionReference](doc/function_reference.md)
    - [ObjectWrap](doc/object_wrap.md)
        - [ClassPropertyDescriptor](doc/class_property_descriptor.md)
    - [Буфер](doc/buffer.md)
    - [ArrayBuffer](doc/array_buffer.md)
    - [TypedArray](doc/typed_array.md)
      - [TypedArrayOf](doc/typed_array_of.md)
    - [DataView](doc/dataview.md)
 - [Обработка ошибок](doc/error_handling.md)
    - [Ошибка](doc/error.md)
      - [TypeError](doc/type_error.md)
      - [RangeError](doc/range_error.md)
 - [Управление временем существования объекта](doc/object_lifetime_management.md)
    - [HandleScope](doc/handle_scope.md)
    - [EscapableHandleScope](doc/escapable_handle_scope.md)
 - [Управление памятью](doc/memory_management.md)
 - [Асинхронные операции](doc/async_operations.md)
    - [AsyncWorker](doc/async_worker.md)
    - [AsyncContext](doc/async_context.md)
    - [Варианты AsyncWorker](doc/async_worker_variants.md)
 - [Потокобезопасные функции](doc/threadsafe.md)
    - [ThreadSafeFunction](doc/threadsafe_function.md)
    - [TypedThreadSafeFunction](doc/typed_threadsafe_function.md)
 - [Обещания](doc/promises.md)
 - [Управление версиями](doc/version_management.md)

<a name="examples"></a>

### <a name="examples"></a>**Примеры**

Вы не знакомы с **node-addon-api**? Ознакомьтесь с нашими **[примерами](https://github.com/nodejs/node-addon-examples)**

- **[Hello World](https://github.com/nodejs/node-addon-examples/tree/HEAD/1_hello_world/node-addon-api)**
- **[Передача аргументов в функцию](https://github.com/nodejs/node-addon-examples/tree/HEAD/2_function_arguments/node-addon-api)**
- **[Обратные вызовы](https://github.com/nodejs/node-addon-examples/tree/HEAD/3_callbacks/node-addon-api)**
- **[Фабрика объектов](https://github.com/nodejs/node-addon-examples/tree/HEAD/4_object_factory/node-addon-api)**
- **[Фабрика функций](https://github.com/nodejs/node-addon-examples/tree/HEAD/5_function_factory/node-addon-api)**
- **[Упаковка объекта C++](https://github.com/nodejs/node-addon-examples/tree/HEAD/6_object_wrap/node-addon-api)**
- **[Фабрика упаковываемого объекта](https://github.com/nodejs/node-addon-examples/tree/HEAD/7_factory_wrap/node-addon-api)**
- **[Передача обтекаемого объекта вокруг](https://github.com/nodejs/node-addon-examples/tree/HEAD/8_passing_wrapped/node-addon-api)**

<a name="tests"></a>

### <a name="tests"></a>**Тесты**

Чтобы выполнить тесты **node-addon-api**, выполните следующие действия:

```
npm install
npm test
```

Не тестируйте устаревшие части запуска API
```
npm install
npm test --disable-deprecated
```

Выполните тесты, предназначенные для определенной версии запуска Node-API
```
npm install
export NAPI_VERSION=X
npm test --NAPI_VERSION=X
```

где X — это версия Node-API, которая вам требуется.

### <a name="debug"></a>**Отладка**

Чтобы выполнить тесты **node-addon-api** с параметром `--debug`:

```
npm run-script dev
```

Если требуется ускорить сборку, выполните следующие действия:

```
npm run-script dev:incremental
```

Ознакомьтесь с нашим **[набором тестов](https://github.com/nodejs/node-addon-api/tree/HEAD/test)**

### <a name="benchmarks"></a>**Тесты производительности**

Доступные тесты производительности можно запустить с помощью следующей команды:

```
npm run-script benchmark
```

Дополнительные сведения о выполнении и добавлении тестов производительности см. в файле[benchmark/README.md](benchmark/README.md).

<a name="resources"></a>

### <a name="more-resource-and-info-about-native-addons"></a>**Дополнительные сведения о ресурсах и собственных надстройках**
- **[Надстройки C++](https://nodejs.org/dist/latest/docs/api/addons.html)**
- **[Node-API](https://nodejs.org/dist/latest/docs/api/n-api.html)**
- **[Node-API — API узла следующего поколения для собственных модулей](https://youtu.be/-Oniup60Afs)**
- **[Миграция JavaScript области определения приложения из NAN в Node-API](https://developer.mongodb.com/article/realm-javascript-nan-to-n-api)**

Поскольку основная задача node-addon-api заключается в том, чтобы предоставить обычный интерфейс API Node-API C в качестве программ-оболочек C++, средства, упрощающие интерфейс n-api/node-addon-api, за счет более удобных шаблонов разработки надстроек Node.js с использованием n-api/node-addon-api, можно опубликовать в NPM в качестве автономных пакетов. Кроме того, такие пакеты рекомендуется пометить с помощью `node-addon-api`, чтобы выделить их для сообщества.

Быстрый способ поиска NPM: [keywords:node-addon-api](https://www.npmjs.com/search?q=keywords%3Anode-addon-api).

<a name="other-bindings"></a>

### <a name="other-bindings"></a>**Другие привязки**

- **[napi-rs](https://napi.rs)** - (`Rust`)

<a name="badges"></a>

### <a name="badges"></a>**Значки**

Рекомендуется использовать значки, чтобы указать минимальную версию Node-API, необходимую для модуля. Это помогает определить, какие основные версии Node.js поддерживаются. Программы обслуживания надстройки могут обратиться к [матрице поддержки Node-API][], чтобы определить, какие версии Node.js предоставляют определенную версию Node-API. Доступны следующие значки:

![Значок Node-API v1](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v1%20Badge.svg)
![Значок Node-API v2](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v2%20Badge.svg)
![Значок Node-API v3](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v3%20Badge.svg)
![Значок Node-API v4](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v4%20Badge.svg)
![Значок Node-API v5](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v5%20Badge.svg)
![Значок Node-API v6](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v6%20Badge.svg)
![Значок Node-API v7](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v7%20Badge.svg)
![Значок Node-API v8](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v8%20Badge.svg)
![Значок экспериментальной версии Node-API](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20Experimental%20Version%20Badge.svg)

## <a name="contributing"></a>**Участие**

Нам рады вносить свой вклад из сообщества в **node-addon-api**!
Дополнительные сведения о расширении этого модуля см. в файле [CONTRIBUTING.md](CONTRIBUTING.md).

<a name="contributors"></a>

## <a name="team-members"></a>Члены команды

### <a name="active"></a>Активен
| Имя                | Ссылка на GitHub                                           |
| ------------------- | ----------------------------------------------------- |
| Анна Хеннингсен     | [addaleax](https://github.com/addaleax)               |
| Чэнжонг Ву       | [legendecas](https://github.com/legendecas)           |
| Габриэль Шулхоф    | [gabrielschulhof](https://github.com/gabrielschulhof) |
| Джим Шлайт        | [jschlight](https://github.com/jschlight)             |
| Майкл Доусон      | [mhdawson](https://github.com/mhdawson)               |
| Кевин Иди          | [KevinEady](https://github.com/KevinEady)
| Никола Дель Гоббо    | [NickNaso](https://github.com/NickNaso)               |

### <a name="emeritus"></a>Почетный
| Имя                | Ссылка на GitHub                                           |
| ------------------- | ----------------------------------------------------- |
| Арунеш Чандра     | [aruneshchandra](https://github.com/aruneshchandra)   |
| Бенджамин Бихольм     | [kkoopa](https://github.com/kkoopa)                   |
| Джейсон Джинчеро    | [jasongin](https://github.com/jasongin)               |
| Хитеш Кавантирт | [digitalinfinity](https://github.com/digitalinfinity) |
| Сампсон Гао         | [sampsongao](https://github.com/sampsongao)           |
| Тейлор Уолл         | [boingoing](https://github.com/boingoing)             |

<a name="license"></a>

Лицензировано [MIT](./LICENSE.md)

[Руководство по стабильности ABI]: https://nodejs.org/en/docs/guides/abi-stability/
[матрице поддержки Node-API]: https://nodejs.org/dist/latest/docs/api/n-api.html#n_api_n_api_version_matrix
