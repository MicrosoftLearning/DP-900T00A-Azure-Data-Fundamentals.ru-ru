---
ms.openlocfilehash: bd96d4c9278b37a2a3626abd3bd91dd20a15e2e1
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052860"
---
<a name="https-proxy-agent"></a>https-proxy-agent
================
### <a name="an-https-proxy-httpagent-implementation-for-https"></a>Реализация прокси-сервера `http.Agent` HTTP(s) для HTTPS
[![Статус сборки](https://github.com/TooTallNate/node-https-proxy-agent/workflows/Node%20CI/badge.svg)](https://github.com/TooTallNate/node-https-proxy-agent/actions?workflow=Node+CI)

Этот модуль предоставляет реализацию `http.Agent`, которая подключается к указанному прокси-серверу HTTP или HTTPS и может использоваться со встроенным модулем `https`.

В частности, эта реализация `Agent` подключается к промежуточному прокси-серверу и выдает [метод HTTP CONNECT][CONNECT], который указывает прокси-серверу открыть прямое TCP-подключение к целевому серверу.

Так как этот агент реализует метод HTTP CONNECT, он также работает с другими протоколами, которые используют этот метод при подключении через прокси-серверы (т. е. WebSocket).
Дополнительные сведения см. в разделе "Примеры" ниже.


<a name="installation"></a>Установка
------------

Установить с `npm`:

``` bash
$ npm install https-proxy-agent
```


<a name="examples"></a>Примеры
--------

#### <a name="https-module-example"></a>Пример модуля `https`

``` js
var url = require('url');
var https = require('https');
var HttpsProxyAgent = require('https-proxy-agent');

// HTTP/HTTPS proxy to connect to
var proxy = process.env.http_proxy || 'http://168.63.76.32:3128';
console.log('using proxy server %j', proxy);

// HTTPS endpoint for the proxy to connect to
var endpoint = process.argv[2] || 'https://graph.facebook.com/tootallnate';
console.log('attempting to GET %j', endpoint);
var options = url.parse(endpoint);

// create an instance of the `HttpsProxyAgent` class with the proxy server information
var agent = new HttpsProxyAgent(proxy);
options.agent = agent;

https.get(options, function (res) {
  console.log('"response" event!', res.headers);
  res.pipe(process.stdout);
});
```

#### <a name="ws-websocket-connection-example"></a>Пример подключения WebSocket `ws`

``` js
var url = require('url');
var WebSocket = require('ws');
var HttpsProxyAgent = require('https-proxy-agent');

// HTTP/HTTPS proxy to connect to
var proxy = process.env.http_proxy || 'http://168.63.76.32:3128';
console.log('using proxy server %j', proxy);

// WebSocket endpoint for the proxy to connect to
var endpoint = process.argv[2] || 'ws://echo.websocket.org';
var parsed = url.parse(endpoint);
console.log('attempting to connect to WebSocket %j', endpoint);

// create an instance of the `HttpsProxyAgent` class with the proxy server information
var options = url.parse(proxy);

var agent = new HttpsProxyAgent(options);

// finally, initiate the WebSocket connection
var socket = new WebSocket(endpoint, { agent: agent });

socket.on('open', function () {
  console.log('"open" event!');
  socket.send('hello world');
});

socket.on('message', function (data, flags) {
  console.log('"message" event! %j %j', data, flags);
  socket.close();
});
```

<a name="api"></a>API
---

### <a name="new-httpsproxyagentobject-options"></a>new HttpsProxyAgent(Object options)

Класс `HttpsProxyAgent` реализует подкласс `http.Agent`, который подключается к указанному прокси-серверу HTTP(s) для проксирования запросов HTTPS и (или) WebSocket. Выполняется это с помощью [метода HTTP `CONNECT`][CONNECT].

Аргумент `options` может быть строковым универсальным кодом ресурса (URI) прокси-сервера, который требуется использовать, или объектом options с более конкретными свойствами:

  * `host` — строка — узел прокси-сервера для подключения (также может использоваться `hostname`). Обязательный.
  * `port` — число — порт прокси-сервера для подключения. Обязательный.
  * `protocol` — строка — если `https:`, используйте TLS для подключения к прокси-серверу.
  * `headers` — объект — дополнительные заголовки HTTP для отправки в методе HTTP CONNECT.
  * Все остальные заданные параметры передаются функциям `net.connect()`/`tls.connect()`.


<a name="license"></a>Лицензия
-------

(Лицензия MIT)

(c) 2013 г., Натан Раджлич (Nathan Rajlich) &lt;nathan@tootallnate.net&gt;

Настоящим любому лицу, получившему копию этого программного обеспечения и связанных с ним файлов документации ("Программное обеспечение"), бесплатно предоставляется разрешение на любые действия с Программным обеспечением, включая, без ограничений, право на использование, копирование, изменение, слияние, публикацию, распространение, сублицензирование и (или) продажу копий Программного обеспечения, а также разрешение делать это лицам, которым предоставлено Программное обеспечение для этого, на следующих условиях:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

[CONNECT]: http://en.wikipedia.org/wiki/HTTP_tunnel#HTTP_CONNECT_Tunneling
