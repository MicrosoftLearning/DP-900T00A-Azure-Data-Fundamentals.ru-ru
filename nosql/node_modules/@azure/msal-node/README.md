---
ms.openlocfilehash: 05bea0332c8376e66d4aed62eab42a50c744536d
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052628"
---
# <a name="microsoft-authentication-library-for-node-msal-node"></a>Библиотека проверки подлинности Майкрософт для Node (msal-node)

[![npm version](https://img.shields.io/npm/v/@azure/msal-node.svg?style=flat)](https://www.npmjs.com/package/@azure/msal-node/)[![npm version](https://img.shields.io/npm/dm/@azure/msal-node.svg)](https://nodei.co/npm/@azure/msal-node/)[![Состояния протестированного объема](https://coveralls.io/repos/github/AzureAD/microsoft-authentication-library-for-js/badge.svg?branch=dev)](https://coveralls.io/github/AzureAD/microsoft-authentication-library-for-js?branch=dev)

| <a href="https://docs.microsoft.com/azure/active-directory/develop/guidedsetups/active-directory-javascriptspa" target="_blank">Начало работы</a> | <a href="https://aka.ms/aaddevv2" target="_blank">Документация по AAD</a> | <a href="https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_node.html" target="_blank">Справочник по библиотеке</a> |
| --- | --- | --- |

В настоящее время `msal-node` находится на этапе разработки, отслеживайте ход проекта [здесь](https://github.com/AzureAD/microsoft-authentication-library-for-js/projects/4). Эта документация находится в состоянии разработки, в нее будут вноситься изменения по мере выхода исправлений `alpha`. **Пока не рекомендуется использовать его в рабочей среде**.

1. [О программе](#about)
2. [Часто задаваемые вопросы](#faq)
3. [Выпуски](#releases)
4. [Предварительные требования](#prerequisites)
5. [Установка](#installation)
6. [Использование](#usage)
7. [Примеры](#samples)
8. [Библиотека сборки](#build-and-test)
9. [Отчеты по безопасности](#security-reporting)
10. [Лицензия](#license)
11. [Правила поведения](#we-value-and-adhere-to-the-microsoft-open-source-code-of-conduct)

## <a name="about"></a>Сведения

Узел MSAL позволяет проверять подлинность пользователей с помощью рабочих и учебных учетных записей [Azure AD](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-overview) (AAD), личных учетных записей Майкрософт (MSA) и поставщиков удостоверений в социальных сетях, таких как Facebook, Google, LinkedIn, учетных записей Майкрософт и пр. через службу [Azure AD B2C](https://docs.microsoft.com/en-us/azure/active-directory-b2c/active-directory-b2c-overview#identity-providers). Она также позволяет приложению получать маркеры для доступа к [службам Microsoft Cloud](https://www.microsoft.com/enterprise), таким как [Microsoft Graph](https://graph.microsoft.io).


### <a name="oauth20-grant-types-supported"></a>Поддерживаемые типы предоставления разрешения OAuth2.0:

Текущая альфа-версия поддерживает следующие способы получения маркеров:

#### <a name="public-client"></a>Общедоступный клиент:
- [Представление разрешения для кода проверки подлинности](https://oauth.net/2/grant-types/authorization-code/) с [PKCE](https://oauth.net/2/pkce/)
- [Предоставление разрешения для кода устройства](https://oauth.net/2/grant-types/device-code/)
- [Предоставление разрешения для токена обновления](https://oauth.net/2/grant-types/refresh-token/)
- [Тихий поток](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-acquire-cache-tokens#acquiring-tokens-silently-from-the-cache)

#### <a name="confidential-client"></a>Конфиденциальный клиент:
- [Предоставление разрешения для кода проверки подлинности](https://oauth.net/2/grant-types/authorization-code/) с учетными данными клиента
- [Предоставление разрешения для токена обновления](https://oauth.net/2/grant-types/refresh-token/)
- [Тихий поток](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-acquire-cache-tokens#acquiring-tokens-silently-from-the-cache)
- [Предоставления разрешения для учетных данных клиента](https://oauth.net/2/grant-types/client-credentials/)
- [Поток On-Behalf-Of](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow)

**[В ближайшее время]** В будущем планируется добавить поддержку для следующих возможностей:
- [Поток встроенной проверки подлинности Windows](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-authentication-flows#integrated-windows-authentication)
- [Поток имени пользователя и пароль](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-authentication-flows#usernamepassword)

Дополнительные сведения о различных типах предоставления разрешений, поддерживаемых библиотеками проверки подлинности Майкрософт, см. [здесь](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-authentication-flows).

### <a name="scenarios-supported"></a>Поддерживаемые сценарии:

Ниже приведены сценарии, поддерживаемые этой библиотекой:
- Классическое приложение, которое вызывает веб-API
- Веб-приложение, вызывающее веб-API
- Веб-API, вызывающие веб-API
- Управляющие программы

Дополнительные сведения о сценариях и потоках проверки подлинности, которые сопоставляются с каждым из них, можно найти [здесь](https://docs.microsoft.com/en-us/azure/active-directory/develop/authentication-flows-app-scenarios).

## <a name="faq"></a>Вопросы и ответы

Дополнительные сведения см. [здесь](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-node/docs/faq.md).

## <a name="prerequisites"></a>Предварительные требования

Перед использованием `@azure/msal-node` необходимо зарегистрировать приложение на портале Azure:

- [Регистрация приложения](https://docs.microsoft.com/en-us/graph/auth-register-app-v2)

## <a name="installation"></a>Установка

### <a name="via-npm"></a>Через NPM
```javascript
npm install @azure/msal-node
```
##  <a name="usage"></a>Использование

### <a name="msal-basics"></a>Основы MSAL
- [Общие сведения о различиях между общедоступным клиентом и конфиденциальными клиентами](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-client-applications)
- [Инициализация приложения общедоступного клиента](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-node/docs/initialize-public-client-application.md)
- [Инициализация приложения конфиденциального клиента](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-node/docs/initialize-confidential-client-application.md)
- [Конфигурация](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-node/docs/configuration.md)
- [Запрос](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-common/docs/request.md)
- [Ответ](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-common/docs/response.md)

## <a name="samples"></a>Примеры
В репозитории содержатся несколько [примеров](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples), в которых для получения маркеров используется узел MSAL. В настоящее время эти примеры используются для ручного тестирования и не предназначены для справки по рекомендациям, поэтому используйте решение и слепо не копируйте этот код в какие-либо рабочие приложения.

- [auth-code](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/auth-code): Экспресс-приложение, использующее поток кода проверки подлинности OAuth2.0.
- [device-code](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/device-code): Приложение командной строки, использующее поток кода устройства OAuth 2.0.
- [refresh-token](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/refresh-token): Приложение командной строки, использующее поток обновления OAuth 2.0.
- [silent-flow](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/silent-flow): Экспресс-приложение, использующее поток кода проверки подлинности OAuth2.0 для получения маркера и хранения в кэше маркеров, а также тихого потока для использования маркеров в кэше маркеров.
- [client-credentials](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/client-credentials): Управляющее приложение, использующее разрешения для учетных данных клиента Oauth 2.0 на получение маркера.
- [on-behalf-of](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/on-behalf-of): Веб-приложение использует поток кода проверки подлинности Oauth 2.0, чтобы получить маркер для веб-API. Веб-API проверяет маркер и вызывает Microsoft Graph от имени пользователя, прошедшего проверку подлинности в веб-приложении.
- [msal-node-extensions](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/extensions/samples/msal-node-extensions): Использует поток кода проверки подлинности для получения маркеров и библиотеки [msal-extensions](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/extensions/), чтобы записать MSAL в кэш маркеров из памяти на диск.

## <a name="build-and-test"></a>Сборка и тестирование

- Если у вас не установлена [lerna](https://github.com/lerna/lerna), выполните `npm install -g lerna`
- Выполните `lerna bootstrap` из любого места в `microsoft-authentication-library-for-js.git`.
- Перейдите в папку `microsoft-authentication-library-for-js/lib/msal-common` и выполните `npm run build`
- Перейдите в папку `microsoft-authentication-library-for-js/lib/msal-node` и выполните `npm run build`

```javascript
// to link msal-node and msal-common packages
lerna bootstrap

// Change to the msal-node package directory
cd lib/msal-common/

// To run build only for node package
npm run build

// Change to the msal-node package directory
cd lib/msal-node/

// To run build only for node package
npm run build
```

### <a name="local-development"></a>Локальная разработка
Ниже приведен список команд, которые, вероятно, будут полезны:

#### `npm run build:modules:watch`
Запускает проект в режиме разработки или наблюдения. Проект будет перестроен после изменений. Для удобства TSDX имеет специальное средство ведения журнала. Сообщения об ошибках отчетливо напечатаны и отформатированы для совместимости с вкладкой «Проблемы» редактора VS Code. Библиотека будет перестроена, если в нее внесены изменения.

#### `npm run build`
Упаковывает пакет в папку `dist`.
Пакет оптимизирован и интегрирован с накопительным пакетом в несколько форматов (CommonJS, UMD и модуль ES).

#### `lerna bootstrap`
Если вы запускаете проект в режиме разработки, просмотра или внесли изменения в `msal-common`, и необходимо, чтобы изменения отобразились в проекте, выполните команду `lerna bootstrap`, чтобы связать все символы. Обратите внимание, что при выполнении команды `npm install` отсоединится весь код, поэтому после установки рекомендуется выполнить `lerna bootstrap`.

#### `npm run lint`
Выполняет eslint с помощью средства форматирования кода

#### <a name="npm-test-npm-run-testcoverage-npm-run-testwatch"></a>`npm test`, `npm run test:coverage`, `npm run test:watch`
Запускает тестовый наблюдатель (Jest) в интерактивном режиме.
По умолчанию выполняет тесты, связанные с файлами, измененными с момента последней фиксации.
Создайте объем протестированного кода, добавив флаг --coverage. Дополнительная настройка не требуется. Jest может собирать сведения об объеме протестированного кода из целых проектов, включая непроверенные файлы.

## <a name="security-reporting"></a>Отчеты по безопасности

Если вы обнаружите проблему безопасности с нашими библиотеками или службами, сообщите о ней на адрес [secure@microsoft.com](mailto:secure@microsoft.com), указав как можно больше подробностей. За это вы можете получить награду в рамках программы [Microsoft Bounty](http://aka.ms/bugbounty). Не публикуйте проблемы безопасности на GitHub или на других общедоступных сайтах. Мы свяжемся с вами вскоре после получения обращения. Рекомендуем вам настроить уведомления о нарушениях безопасности. Это можно сделать, подписавшись на уведомления безопасности консультационных служб на [этой странице](https://technet.microsoft.com/security/dd252948).

## <a name="license"></a>Лицензия

(c) Корпорация Майкрософт (Microsoft Corporation). Все права защищены  Все права защищены. Лицензировано с задействованием лицензии MIT.

## <a name="we-value-and-adhere-to-the-microsoft-open-source-code-of-conduct"></a>Мы соблюдаем Кодекс Майкрософт по обращению с ПО с открытым исходным кодом

В рамках этого проекта действуют [правила поведения в отношении продуктов с открытым исходным кодом Майкрософт](https://opensource.microsoft.com/codeofconduct/). Дополнительные сведения:[вопросы и ответы по правилам поведения](https://opensource.microsoft.com/codeofconduct/faq/). С любыми другими вопросами или комментариями обращайтесь по адресу[opencode@microsoft.com](mailto:opencode@microsoft.com).

