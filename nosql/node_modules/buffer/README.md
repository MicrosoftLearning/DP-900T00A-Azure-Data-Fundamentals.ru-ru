---
ms.openlocfilehash: 10d69c50139d95dc37feaab872c5c2848fd3b089
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052247"
---
# <a name="buffer-travistravis-imagetravis-url-npmnpm-imagenpm-url-downloadsdownloads-imagedownloads-url-javascript-style-guidestandard-imagestandard-url"></a>buffer [![travis][travis-image]][travis-url] [![npm][npm-image]][npm-url] [![загрузки][downloads-image]][downloads-url] [![javascript, руководство по стилю][standard-image]][standard-url]

[travis-image]: https://img.shields.io/travis/feross/buffer/master.svg
[travis-url]: https://travis-ci.org/feross/buffer
[npm-image]: https://img.shields.io/npm/v/buffer.svg
[npm-url]: https://npmjs.org/package/buffer
[downloads-image]: https://img.shields.io/npm/dm/buffer.svg
[downloads-url]: https://npmjs.org/package/buffer
[standard-image]: https://img.shields.io/badge/code_style-standard-brightgreen.svg
[standard-url]: https://standardjs.com

#### <a name="the-buffer-module-from-nodejs-for-the-browser"></a>Модуль Buffer из [node.js](https://nodejs.org/) для браузера.

[![saucelabs][saucelabs-image]][saucelabs-url]

[saucelabs-image]: https://saucelabs.com/browser-matrix/buffer.svg
[saucelabs-url]: https://saucelabs.com/u/buffer

При использовании средства [browserify](http://browserify.org), чтобы получить этот модуль, достаточно указать `require('buffer')` или глобальную декларацию `Buffer`.

Цель — предоставить API, который идентичен [API Buffer в node.js](https://nodejs.org/api/buffer.html). Полный список поддерживаемых свойств, методов экземпляра и методов класса см. в [официальной документации](https://nodejs.org/api/buffer.html).

## <a name="features"></a>features

- Весь спектр возможностей работы с двоичными данными во всех браузерах.
- Исключительная скорость работы. На базе типизированных массивов (`Uint8Array`/`ArrayBuffer`, а не `Object`)
- Очень маленький размер пакета (**6,75 КБ минифицированный архив**, 51,9 КБ с комментариями)
- Отличная поддержка браузеров (Chrome, Firefox, Edge, Safari 9+, IE 11, iOS 9+, Android и т. д.)
- Полностью повторяет API в node.js с одним незначительным отличием (см. ниже)
- Поддержка нотации с квадратными скобками `buf[4]`
- Не меняет прототипы браузеров и не добавляет ничего в `window`
- Комплексный набор тестов (включая все тесты Buffer из ядра node.js)

## <a name="install"></a>Установка

Чтобы использовать этот модуль напрямую (без browserify), установите его:

```bash
npm install buffer
```

Этот модуль раньше назывался **native-buffer-browserify**, но теперь используйте название **buffer**.

Если вы не используете средство увязки в пакет, можно использовать [автономный сценарий](https://bundle.run/buffer).

## <a name="usage"></a>usage

API модуля идентичен API `Buffer` в node.js. Полный список поддерживаемых свойств, методов экземпляра и методов класса см. в [официальной документации](https://nodejs.org/api/buffer.html).

Как упоминалось выше, чтобы автоматически включить этот модуль в пакет, укажите `require('buffer')` или используйте глобальную декларацию `Buffer` с [browserify](http://browserify.org). В браузере будет работать практически любой модуль npm, даже если предполагается доступность API `Buffer` из node.js.

Чтобы явно задать зависимость от этого модуля (без browserify), укажите:

```js
var Buffer = require('buffer/').Buffer  // note: the trailing slash is important!
```

Чтобы явно включить этот модуль в пакет, укажите директиву `require('buffer/')`. Она предписывает алгоритму поиска модулей в node.js (также используется в browserify) использовать **модуль npm** с именем `buffer` вместо **модуля из ядра node.js** с именем `buffer`.


## <a name="how-does-it-work"></a>Как это работает?

Конструктор Buffer возвращает экземпляры `Uint8Array`, прототип которых изменен на `Buffer.prototype`. Кроме того, `Buffer` является подклассом `Uint8Array`, поэтому возвращаемые экземпляры будут иметь все методы `Buffer` из node.js и методы `Uint8Array`. Нотация с квадратными скобками работает должным образом, возвращая один октет.

Прототип `Uint8Array` остается без изменений.


## <a name="tracking-the-latest-node-api"></a>Отслеживание последнего API в node.js

Этот модуль отслеживает API Buffer в последней (нестабильной) версии node.js. API Buffer считается **стабильным** в [указателе стабильности node.js](https://nodejs.org/docs/latest/api/documentation.html#documentation_stability_index), поэтому маловероятно, что в нем когда-либо будут критические изменения.
Тем не менее, когда или если API Buffer в node.js изменится, API этого модуля изменится соответствующим образом.

## <a name="related-packages"></a>Связанные пакеты

- [`buffer-reverse`](https://www.npmjs.com/package/buffer-reverse) — обратный буфер
- [`buffer-xor`](https://www.npmjs.com/package/buffer-xor) — побитовое исключающее ИЛИ для буфера
- [`is-buffer`](https://www.npmjs.com/package/is-buffer) — определяет, является ли объект экземпляром Buffer без включения всего пакета `Buffer`

## <a name="conversion-packages"></a>Пакеты преобразования

### <a name="convert-typed-array-to-buffer"></a>Преобразование типизированного массива в буфер

[`typedarray-to-buffer`](https://www.npmjs.com/package/typedarray-to-buffer) позволяет преобразовать любой типизированный массив в `Buffer`. При этом копия не создается, поэтому операция выполняется очень быстро.

### <a name="convert-buffer-to-typed-array"></a>Преобразование буфера в типизированный массив

`Buffer` является подклассом `Uint8Array` (который представляет собой типизированный массив). Поэтому нет необходимости явно преобразовывать буфер в типизированный массив. Просто используйте буфер как `Uint8Array`.

### <a name="convert-blob-to-buffer"></a>Преобразование большого двоичного объекта в буфер

[`blob-to-buffer`](https://www.npmjs.com/package/blob-to-buffer) позволяет преобразовать `Blob` в `Buffer`.

### <a name="convert-buffer-to-blob"></a>Преобразование буфера в большой двоичный объект

Чтобы преобразовать `Buffer` в `Blob`, используйте конструктор `Blob`:

```js
var blob = new Blob([ buffer ])
```

При необходимости укажите тип MIME:

```js
var blob = new Blob([ buffer ], { type: 'text/html' })
```

### <a name="convert-arraybuffer-to-buffer"></a>Преобразование arraybuffer в буфер

Чтобы преобразовать `ArrayBuffer` в `Buffer`, используйте функцию `Buffer.from`. При этом копия не создается, поэтому операция выполняется очень быстро.

```js
var buffer = Buffer.from(arrayBuffer)
```

### <a name="convert-buffer-to-arraybuffer"></a>Преобразование буфера в arraybuffer

Чтобы преобразовать `Buffer` в `ArrayBuffer`, используйте свойство `.buffer` (которое имеется во всех объектах `Uint8Array`):

```js
var arrayBuffer = buffer.buffer.slice(
  buffer.byteOffset, buffer.byteOffset + buffer.byteLength
)
```

Либо используйте модуль [`to-arraybuffer`](https://www.npmjs.com/package/to-arraybuffer).

## <a name="performance"></a>производительность

См. тесты perf в `/perf`.

`BrowserBuffer` — это модуль браузера `buffer` (данный репозиторий). `Uint8Array` включается в качестве проверки работоспособности (так как в основе `BrowserBuffer` лежит `Uint8Array`, `Uint8Array` всегда будет по крайней мере немного быстрее). Наконец, `NodeBuffer` — это модуль буфера node.js, который включается для сравнения.

ПРИМЕЧАНИЕ. Производительность повысилась с тех пор, как были приняты эти тесты. Предложение обновить README.

### <a name="chrome-38"></a>Chrome 38

| Метод | Операции | Точность | с выборкой; | Самый быстрый |
|:-------|:-----------|:---------|:--------|:-------:|
| BrowserBuffer#bracket-notation | 11 457 464 оп/с | ±0,86 % | 66 | ✓ |
| Uint8Array#bracket-notation | 10 824 332 оп/с | ±0,74 % | 65 | |
| | | | |
| BrowserBuffer#concat | 450 532 оп/с | ±0,76 % | 68 | |
| Uint8Array#concat | 1 368 911 оп/с | ±1,5 % | 62 | ✓ |
| | | | |
| BrowserBuffer#copy(16000) | 903 001 оп/с | ±0,96 % | 67 | |
| Uint8Array#copy(16000) | 1 422 441 оп/с | ±1,04 % | 66 | ✓ |
| | | | |
| BrowserBuffer#copy(16) | 11 431 358 оп/с | ±0,46 % | 69 | |
| Uint8Array#copy(16) | 13 944 163 оп/с | ±1,12 % | 68 | ✓ |
| | | | |
| BrowserBuffer#new(16000) | 106 329 оп/с | ±6,70 % | 44 | |
| Uint8Array#new(16000) | 131 001 оп/с | ±2,85 % | 31 | ✓ |
| | | | |
| BrowserBuffer#new(16) | 1 554 491 оп/с | ±1,6 % | 65 | |
| Uint8Array#new(16) | 6 623 930 оп/с | ±1,66 % | 65 | ✓ |
| | | | |
| BrowserBuffer#readDoubleBE | 112 830 оп/с | ±0,51 % | 69 | ✓ |
| DataView#getFloat64 | 93 500 оп/с | ±0,57 % | 68 | |
| | | | |
| BrowserBuffer#readFloatBE | 146 678 оп/с | ±0,95 % | 68 | ✓ |
| DataView#getFloat32 | 99 311 оп/с | ±0,41 % | 67 | |
| | | | |
| BrowserBuffer#readUInt32LE | 843 214 оп/с | ±0,7 % | 69 | ✓ |
| DataView#getUint32 | 103 024 оп/с | ±0,64 % | 67 | |
| | | | |
| BrowserBuffer#slice | 1 013 941 оп/с | ±0,75 % | 67 | |
| Uint8Array#subarray | 1 903 928 оп/с | ±0,53 % | 67 | ✓ |
| | | | |
| BrowserBuffer#writeFloatBE | 61 387 оп/с | ±0,90 % | 67 | |
| DataView#setFloat32 | 141 249 оп/с | ±0,4 % | 66 | ✓ |


### <a name="firefox-33"></a>Firefox 33

| Метод | Операции | Точность | с выборкой; | Самый быстрый |
|:-------|:-----------|:---------|:--------|:-------:|
| BrowserBuffer#bracket-notation | 20 800 421 оп/с | ±1,84 % | 60 | |
| Uint8Array#bracket-notation | 20 826 235 оп/с | ±2,02 % | 61 | ✓ |
| | | | |
| BrowserBuffer#concat | 153 076 оп/с | ±2,32 % | 61 | |
| Uint8Array#concat | 1 255 674 оп/с | ±8,65 % | 52 | ✓ |
| | | | |
| BrowserBuffer#copy(16000) | 1 105 312 оп/с | ±1,16 % | 63 | |
| Uint8Array#copy(16000) | 1 615 911 оп/с | ±0,55 % | 66 | ✓ |
| | | | |
| BrowserBuffer#copy(16) | 16 357 599 оп/с | ±0,73 % | 68 | |
| Uint8Array#copy(16) | 31 436 281 оп/с | ±1,05 % | 68 | ✓ |
| | | | |
| BrowserBuffer#new(16000) | 52 995 оп/с | ±6,01 % | 35 | |
| Uint8Array#new(16000) | 87 686 оп/с | ±5,68 % | 45 | ✓ |
| | | | |
| BrowserBuffer#new(16) | 252 031 оп/с | ±1,61 % | 66 | |
| Uint8Array#new(16) | 8 477 026 оп/с | ±0,49 % | 68 | ✓ |
| | | | |
| BrowserBuffer#readDoubleBE | 99 871 оп/с | ±0,41 % | 69 | |
| DataView#getFloat64 | 285 663 оп/с | ±0,7 % | 68 | ✓ |
| | | | |
| BrowserBuffer#readFloatBE | 115 540 оп/с | ±0,42 % | 69 | |
| DataView#getFloat32 | 288 722 оп/с | ±0,82 % | 68 | ✓ |
| | | | |
| BrowserBuffer#readUInt32LE | 633 926 оп/с | ±1,08 % | 67 | ✓ |
| DataView#getUint32 | 294 808 оп/с | ±0,79 % | 64 | |
| | | | |
| BrowserBuffer#slice | 349 425 оп/с | ±0,46 % | 69 | |
| Uint8Array#subarray | 5 965 819 оп/с | ±0,6 % | 65 | ✓ |
| | | | |
| BrowserBuffer#writeFloatBE | 59 980 оп/с | ±0,41 % | 67 | |
| DataView#setFloat32 | 317 634 оп/с | ±0,63 % | 68 | ✓ |

### <a name="safari-8"></a>Safari 8

| Метод | Операции | Точность | с выборкой; | Самый быстрый |
|:-------|:-----------|:---------|:--------|:-------:|
| BrowserBuffer#bracket-notation | 10 279 729 оп/с | ±2,25 % | 56 | ✓ |
| Uint8Array#bracket-notation | 10 030 767 оп/с | ±2,23 % | 59 | |
| | | | |
| BrowserBuffer#concat | 144 138 оп/с | ±1,38 % | 65 | |
| Uint8Array#concat | 4 950 764 оп/с | ±1,7 % | 63 | ✓ |
| | | | |
| BrowserBuffer#copy(16000) | 1 058 548 оп/с | ±1,51 % | 64 | |
| Uint8Array#copy(16000) | 1 409 666 оп/с | ±1,17 % | 65 | ✓ |
| | | | |
| BrowserBuffer#copy(16) | 6 282 529 оп/с | ±1,88 % | 58 | |
| Uint8Array#copy(16) | 11 907 128 оп/с | ±2,87 % | 58 | ✓ |
| | | | |
| BrowserBuffer#new(16000) | 101 663 оп/с | ±3,89 % | 57 | |
| Uint8Array#new(16000) | 22 050 818 оп/с | ±6,51 % | 46 | ✓ |
| | | | |
| BrowserBuffer#new(16) | 176 072 оп/с | ±2,13 % | 64 | |
| Uint8Array#new(16) | 24 385 731 оп/с | ±5,01 % | 51 | ✓ |
| | | | |
| BrowserBuffer#readDoubleBE | 41 341 оп/с | ±1,06 % | 67 | |
| DataView#getFloat64 | 322 280 оп/с | ±0,84 % | 68 | ✓ |
| | | | |
| BrowserBuffer#readFloatBE | 46 141 оп/с | ±1,06 % | 65 | |
| DataView#getFloat32 | 337 025 оп/с | ±0,43 % | 69 | ✓ |
| | | | |
| BrowserBuffer#readUInt32LE | 151 551 оп/с | ±1,02 % | 66 | |
| DataView#getUint32 | 308 278 оп/с | ±0,94 % | 67 | ✓ |
| | | | |
| BrowserBuffer#slice | 197 365 оп/с | ±0,95 % | 66 | |
| Uint8Array#subarray | 9 558 024 оп/с | ±3,08 % | 58 | ✓ |
| | | | |
| BrowserBuffer#writeFloatBE | 17 518 оп/с | ±1,03 % | 63 | |
| DataView#setFloat32 | 319 751 оп/с | ±0,48 % | 68 | ✓ |


### <a name="node-01114"></a>Node 0.11.14

| Метод | Операции | Точность | с выборкой; | Самый быстрый |
|:-------|:-----------|:---------|:--------|:-------:|
| BrowserBuffer#bracket-notation | 10 489 828 оп/с | ±3,25 % | 90 | |
| Uint8Array#bracket-notation | 10 534 884 оп/с | ±0,81 % | 92 | ✓ |
| NodeBuffer#bracket-notation | 10 389 910 оп/с | ±0,97 % | 87 | |
| | | | |
| BrowserBuffer#concat | 487 830 оп/с | ±2,58 % | 88 | |
| Uint8Array#concat | 1 814 327 оп/с | ±1,28 % | 88 | ✓ |
| NodeBuffer#concat | 1 636 523 оп/с | ±1,88 % | 73 | |
| | | | |
| BrowserBuffer#copy(16000) | 1 073 665 оп/с | ±0,77 % | 90 | |
| Uint8Array#copy(16000) | 1 348 517 оп/с | ±0,84 % | 89 | ✓ |
| NodeBuffer#copy(16000) | 1 289 533 оп/с | ±0,82 % | 93 | |
| | | | |
| BrowserBuffer#copy(16) | 12 782 706 оп/с | ±0,74 % | 85 | |
| Uint8Array#copy(16) | 14 180 427 оп/с | ±0,93 % | 92 | ✓ |
| NodeBuffer#copy(16) | 11 083 134 оп/с | ±1,06 % | 89 | |
| | | | |
| BrowserBuffer#new(16000) | 141 678 оп/с | ±3,3 % | 67 | |
| Uint8Array#new(16000) | 161 491 оп/с | ±2,96 % | 60 | |
| NodeBuffer#new(16000) | 292 699 оп/с | ±3,2 % | 55 | ✓ |
| | | | |
| BrowserBuffer#new(16) | 1 655 466 оп/с | ±2,41 % | 82 | |
| Uint8Array#new(16) | 14 399 926 оп/с | ±0,91 % | 94 | ✓ |
| NodeBuffer#new(16) | 3 894 696 оп/с | ±0,88 % | 92 | |
| | | | |
| BrowserBuffer#readDoubleBE | 109 582 оп/с | ±0,75 % | 93 | ✓ |
| DataView#getFloat64 | 91 235 оп/с | ±0,81 % | 90 | |
| NodeBuffer#readDoubleBE | 88 593 оп/с | ±0,96 % | 81 | |
| | | | |
| BrowserBuffer#readFloatBE | 139 854 оп/с | ±1,03 % | 85 | ✓ |
| DataView#getFloat32 | 98 744 оп/с | ±0,8 % | 89 | |
| NodeBuffer#readFloatBE | 92 769 оп/с | ±0,94 % | 93 | |
| | | | |
| BrowserBuffer#readUInt32LE | 710 861 оп/с | ±0,82 % | 92 | |
| DataView#getUint32 | 117 893 оп/с | ±0,84 % | 91 | |
| NodeBuffer#readUInt32LE | 851 412 оп/с | ±0,72 % | 93 | ✓ |
| | | | |
| BrowserBuffer#slice | 1 673 877 оп/с | ±0,73 % | 94 | |
| Uint8Array#subarray | 6 919 243 оп/с | ±0,67 % | 90 | ✓ |
| NodeBuffer#slice | 4 617 604 оп/с | ±0,79 % | 93 | |
| | | | |
| BrowserBuffer#writeFloatBE | 66 011 оп/с | ±0,75 % | 93 | |
| DataView#setFloat32 | 127 760 оп/с | ±0,72 % | 93 | ✓ |
| NodeBuffer#writeFloatBE | 103 352 оп/с | ±0,83 % | 93 | |

### <a name="iojs-181"></a>iojs 1.8.1

| Метод | Операции | Точность | с выборкой; | Самый быстрый |
|:-------|:-----------|:---------|:--------|:-------:|
| BrowserBuffer#bracket-notation | 10 990 488 оп/с | ±1,11 % | 91 | |
| Uint8Array#bracket-notation | 11 268 757 оп/с | ±0,65 % | 97 | |
| NodeBuffer#bracket-notation | 11 353 260 оп/с | ±0,83 % | 94 | ✓ |
| | | | |
| BrowserBuffer#concat | 378 954 оп/с | ±0,74 % | 94 | |
| Uint8Array#concat | 1 358 288 оп/с | ±0,97 % | 87 | |
| NodeBuffer#concat | 1 934 050 оп/с | ±1,11 % | 78 | ✓ |
| | | | |
| BrowserBuffer#copy(16000) | 894 538 оп/с | ±0,56 % | 84 | |
| Uint8Array#copy(16000) | 1 442 656 оп/с | ±0,71 % | 96 | |
| NodeBuffer#copy(16000) | 1 457 898 оп/с | ±0,53 % | 92 | ✓ |
| | | | |
| BrowserBuffer#copy(16) | 12 870 457 оп/с | ±0,67 % | 95 | |
| Uint8Array#copy(16) | 16 643 989 оп/с | ±0,61 % | 93 | ✓ |
| NodeBuffer#copy(16) | 14 885 848 оп/с | ±0,74 % | 94 | |
| | | | |
| BrowserBuffer#new(16000) | 109 264 оп/с | ±4,21 % | 63 | |
| Uint8Array#new(16000) | 138 916 оп/с | ±1,87 % | 61 | |
| NodeBuffer#new(16000) | 281 449 оп/с | ±3,58 % | 51 | ✓ |
| | | | |
| BrowserBuffer#new(16) | 1 362 935 оп/с | ±0,56 % | 99 | |
| Uint8Array#new(16) | 6 193 090 оп/с | ±0,64 % | 95 | ✓ |
| NodeBuffer#new(16) | 4 745 425 оп/с | ±1,56 % | 90 | |
| | | | |
| BrowserBuffer#readDoubleBE | 118 127 оп/с | ±0,59 % | 93 | ✓ |
| DataView#getFloat64 | 107 332 оп/с | ±0,65 % | 91 | |
| NodeBuffer#readDoubleBE | 116 274 оп/с | ±0,94 % | 95 | |
| | | | |
| BrowserBuffer#readFloatBE | 150 326 оп/с | ±0,58 % | 95 | ✓ |
| DataView#getFloat32 | 110 541 оп/с | ±0,57 % | 98 | |
| NodeBuffer#readFloatBE | 121 599 оп/с | ±0,6 % | 87 | |
| | | | |
| BrowserBuffer#readUInt32LE | 814 147 оп/с | ±0,62 % | 93 | |
| DataView#getUint32 | 137 592 оп/с | ±0,64 % | 90 | |
| NodeBuffer#readUInt32LE | 931 650 оп/с | ±0,71 % | 96 | ✓ |
| | | | |
| BrowserBuffer#slice | 878 590 оп/с | ±0,68 % | 93 | |
| Uint8Array#subarray | 2 843 308 оп/с | ±1,02 % | 90 | |
| NodeBuffer#slice | 4 998 316 оп/с | ±0,68 % | 90 | ✓ |
| | | | |
| BrowserBuffer#writeFloatBE | 65 927 оп/с | ±0,74 % | 93 | |
| DataView#setFloat32 | 139 823 оп/с | ±0,97 % | 89 | ✓ |
| NodeBuffer#writeFloatBE | 135 763 оп/с | ±0,65 % | 96 | |
| | | | |

## <a name="testing-the-project"></a>Тестирование проекта

Сначала установите проект:

    npm install

Затем, чтобы запустить тесты в Node.js, выполните следующую команду:

    npm run test-node

Чтобы протестировать локально в браузере, можно выполнить команды:

    npm run test-browser-es5-local # For ES5 browsers that don't support ES6
    npm run test-browser-es6-local # For ES6 compliant browsers

В результате будет выведен URL-адрес, который можно открыть в браузере для выполнения тестов с помощью [airtap](https://www.npmjs.com/package/airtap).

Чтобы запустить автоматические тесты браузера с помощью Saucelabs, убедитесь, что заданы переменные среды `SAUCE_USERNAME` и `SAUCE_ACCESS_KEY`, а затем выполните следующую команду:

    npm test

Это выполняется в Travis для сравнения разных браузеров. Список браузеров хранится в файлах `bin/airtap-es5.yml` и `bin/airtap-es6.yml`.

## <a name="javascript-standard-style"></a>Стандартный стиль JavaScript

В этом модуле используется [стандартный стиль JavaScript](https://github.com/feross/standard).

[![Руководство по стилю JavaScript](https://cdn.rawgit.com/feross/standard/master/badge.svg)](https://github.com/feross/standard)

Чтобы проверить, соответствует ли код стилю, выполните команду `npm install` и команду:

    ./node_modules/.bin/standard

## <a name="credit"></a>Благодарности

Изначально была создана вилка из [buffer-browserify](https://github.com/toots/buffer-browserify).

## <a name="security-policies-and-procedures"></a>Политики и процедуры безопасности

Команда и сообщество `buffer` серьезно относятся ко всем ошибкам безопасности в `buffer`. Узнать, как сообщать о проблемах, можно в наших [политиках и процедурах безопасности](https://github.com/feross/security).

## <a name="license"></a>license

MIT. (C) [Феросс Абухадиджа](http://feross.org) и другие участники. Первоначально вилку создал Ромен Бози из модуля, лицензированного MIT.
